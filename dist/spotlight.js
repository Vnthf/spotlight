!function(t,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var e=o();for(var s in e)("object"==typeof exports?exports:t)[s]=e[s]}}(window,function(){return function(t){var o={};function e(s){if(o[s])return o[s].exports;var i=o[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=o,e.d=function(t,o,s){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:s})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="/dist",e(e.s=0)}([function(t,o,e){"use strict";e.r(o);const s=()=>navigator&&navigator.platform.toUpperCase().indexOf("MAC")>=0;var i={isMac:s,getMaskBackground:(t,o,{radius:e,dimmedColor:s})=>"radial-gradient(circle at "+t+"px "+o+"px, transparent "+e+"px, "+s+" 0)"};const n={ESC:27,SHIFT:16,CTRL:s()?91:17};e(1);e.d(o,"SpotLight",function(){return r});class r{constructor(t){this.changeOption(t),this._attachEvent()}_computeOptions(t){let o=t.el||document.body.firstElementChild,e={dimmedColor:"rgba(0,0,0,0.4)",zoomedColor:"#fff",zoomKey:i.isMac()?"metaKey":"ctrlKey",zoomScale:2,zIndex:1e3,el:o,radius:t.el.getBoundingClientRect().width/4};return Object.assign({},e,t)}changeOption(t){this.options=this._computeOptions(t)}_attachEvent(){document.addEventListener("keyup",t=>{n.SHIFT===t.keyCode&&this.stopMask(),n.CTRL===t.keyCode&&this.stopZoom()}),document.addEventListener("keydown",t=>{n.SHIFT===t.keyCode&&this.startMask(),t.shiftKey&&n.CTRL===t.keyCode&&this.startZoom(t)}),document.addEventListener("mousemove",this.onMove.bind(this))}remove(){}startMask(){this.$mask||(this.$mask=document.createElement("div"),this.$mask.classList.add("spotlight-mask"),document.body.appendChild(this.$mask),this.setMask())}setMask(){let t=i.getMaskBackground(this.x,this.y,this.options);this.$mask.setAttribute("style",`\n\t\t\tbackground-image: ${t}; \n\t\t\tbackground-image: -webkit-${t};\n\t\t\tposition: fixed;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tcursor: none;\n\t\t\tz-index: ${this.options.zIndex}`)}stopMask(){this.$mask&&this.$mask.remove(),this.stopZoom(),this.$mask=null}startZoom(){this.$zoom||(this.$zoom=document.createElement("div"),this.$zoom.classList.add("spotlight-zoom"),this.$zoomContent=this.options.el.cloneNode(!0),this.$zoomContent.classList.add("spotlight-zoom-content"),this.$zoom.setAttribute("style",`\n\t\t\twidth: ${2*this.options.radius}px; \n\t\t\theight: ${2*this.options.radius}px;\n\t\t\toverflow: hidden;\n\t\t\tborder-radius: 50%;\n\t\t\tposition: fixed;`),this.$zoomContent.setAttribute("style",`\n\t\t\twidth: ${this.options.el.offsetWidth}px; \n\t\t\theight: ${this.options.el.offsetHeight}px;\n\t\t\tbackground-color: ${this.options.zoomedColor};\n\t\t\tposition: fixed;\n\t\t\ttransform: scale(${this.options.zoomScale});\n\t\t\toverflow: ${this.options.el.style.overflow};\n\t\t\tz-index: ${this.options.zIndex+1}`),document.body.appendChild(this.$zoom),this.$zoom.appendChild(this.$zoomContent),this.elRect=this.options.el.getBoundingClientRect(),this.$zoomContent.scrollTop=parseInt(this.options.el.scrollTop,10),this.$zoomContent.scrollLeft=parseInt(this.options.el.scrollLeft,10),this.setZoom())}setZoom(){let t=this.options.zoomScale;this.$zoom.style.top=`${this.y-this.options.radius}px`,this.$zoom.style.left=`${this.x-this.options.radius}px`,this.$zoomContent.style.top=`${this.y-this.options.radius}px`,this.$zoomContent.style.left=`${this.x-this.options.radius}px`,this.$zoomContent.style.marginTop=-t*(this.y-this.elRect.top)+this.options.el.offsetHeight*(t-1)/2+this.options.radius+"px",this.$zoomContent.style.marginLeft=-t*(this.x-this.elRect.left)+this.options.el.offsetWidth*(t-1)/2+this.options.radius+"px"}stopZoom(){this.$zoom&&this.$zoom.remove(),this.$zoom=null}onMove(t){this.x=t.clientX,this.y=t.clientY,this.$mask&&(t.shiftKey||this.stopMask(),!t[this.options.zoomKey]&&this.$zoom&&this.stopZoom(),this.setMask(),t[this.options.zoomKey]&&this.setZoom())}}},function(t,o){[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29uZmlnLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcG9seWZpbGwuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwiYSIsImkiLCJ3aW5kb3ciLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwidmFsdWUiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImlzTWFjIiwibmF2aWdhdG9yIiwicGxhdGZvcm0iLCJ0b1VwcGVyQ2FzZSIsImluZGV4T2YiLCJ1dGlsIiwiZ2V0TWFza0JhY2tncm91bmQiLCJ4IiwieSIsInJhZGl1cyIsImRpbW1lZENvbG9yIiwiS0VZX0NPREUiLCJFU0MiLCJTSElGVCIsIkNUUkwiLCJzcmNfU3BvdExpZ2h0IiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwidGhpcyIsImNoYW5nZU9wdGlvbiIsIl9hdHRhY2hFdmVudCIsIl9jb21wdXRlT3B0aW9ucyIsImVsIiwiZG9jdW1lbnQiLCJib2R5IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJkZWZhdWx0T3B0aW9ucyIsInpvb21lZENvbG9yIiwiem9vbUtleSIsInpvb21TY2FsZSIsInpJbmRleCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIndpZHRoIiwiYXNzaWduIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJrZXlDb2RlIiwic3RvcE1hc2siLCJzdG9wWm9vbSIsInN0YXJ0TWFzayIsInNoaWZ0S2V5Iiwic3RhcnRab29tIiwib25Nb3ZlIiwiYmluZCIsInJlbW92ZSIsIiRtYXNrIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwic2V0TWFzayIsImltYWdlQ3NzIiwic2V0QXR0cmlidXRlIiwiJHpvb20iLCIkem9vbUNvbnRlbnQiLCJjbG9uZU5vZGUiLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsInN0eWxlIiwib3ZlcmZsb3ciLCJlbFJlY3QiLCJzY3JvbGxUb3AiLCJwYXJzZUludCIsInNjcm9sbExlZnQiLCJzZXRab29tIiwic2NhbGUiLCJ0b3AiLCJsZWZ0IiwibWFyZ2luVG9wIiwibWFyZ2luTGVmdCIsImNsaWVudFgiLCJjbGllbnRZIiwiRWxlbWVudCIsIkNoYXJhY3RlckRhdGEiLCJEb2N1bWVudFR5cGUiLCJmb3JFYWNoIiwiaXRlbSIsIndyaXRhYmxlIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLG9CQUFBQyxTQUFBLGlCQUFBQyxPQUNBQSxPQUFBRCxRQUFBRCxTQUNBLHNCQUFBRyxlQUFBQyxJQUNBRCxVQUFBSCxPQUNBLENBQ0EsSUFBQUssRUFBQUwsSUFDQSxRQUFBTSxLQUFBRCxHQUFBLGlCQUFBSixnQkFBQUYsR0FBQU8sR0FBQUQsRUFBQUMsSUFQQSxDQVNDQyxPQUFBLFdBQ0QsbUJDVEEsSUFBQUMsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQVQsUUFHQSxJQUFBQyxFQUFBTSxFQUFBRSxJQUNBSixFQUFBSSxFQUNBQyxHQUFBLEVBQ0FWLFlBVUEsT0FOQVcsRUFBQUYsR0FBQUcsS0FBQVgsRUFBQUQsUUFBQUMs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LEdBQUdtQyxjQUFnQlEsRUFBTyxHQUFHLEVBQUkvQyxLQUFLRCxRQUFRUixPQUFTLEtBQy9JUyxLQUFLb0MsYUFBYUksTUFBTVcsWUFBZUosR0FBUy9DLEtBQUtYLEVBQUlXLEtBQUswQyxPQUFPTyxNQUFRakQsS0FBS0QsUUFBUUssR0FBR2tDLGFBQWVTLEVBQU8sR0FBRyxFQUFJL0MsS0FBS0QsUUFBUVIsT0FBUyxLQUdqSjZCLFdBQ0NwQixLQUFLbUMsT0FBU25DLEtBQUttQyxNQUFNVCxTQUN6QjFCLEtBQUttQyxNQUFRLEtBR2RYLE9BQU9QLEdBQ05qQixLQUFLWCxFQUFJNEIsRUFBRW1DLFFBQ1hwRCxLQUFLVixFQUFJMkIsRUFBRW9DLFFBRVByRCxLQUFLMkIsUUFJSlYsRUFBRUssVUFDTnRCLEtBQUttQixZQUdERixFQUFFakIsS0FBS0QsUUFBUVcsVUFBWVYsS0FBS21DLE9BQ3BDbkMsS0FBS29CLFdBR05wQixLQUFLZ0MsVUFFRGYsRUFBRWpCLEtBQUtELFFBQVFXLFVBQ2xCVixLQUFLOEMsNkJDeklKUSxRQUFRNUUsVUFBVzZFLGNBQWM3RSxVQUFXOEUsYUFBYTlFLFdBZHhEK0UsUUFBUSxTQUFVQyxHQUNqQkEsRUFBSy9FLGVBQWUsV0FHeEJaLE9BQU9DLGVBQWUwRixFQUFNLFVBQzNCekYsY0FBYyxFQUNkQyxZQUFZLEVBQ1p5RixVQUFVLEVBQ1Z0RixNQUFPLFdBQ2tCLE9BQXBCMkIsS0FBSzRELFlBQ1I1RCxLQUFLNEQsV0FBV0MsWUFBWTdEIiwiZmlsZSI6InNwb3RsaWdodC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KSh3aW5kb3csIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9kaXN0XCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBjb25zdCBpc01hYyA9ICgpID0+IHtcblx0cmV0dXJuIG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IucGxhdGZvcm0udG9VcHBlckNhc2UoKS5pbmRleE9mKCdNQUMnKSA+PSAwO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldE1hc2tCYWNrZ3JvdW5kID0gKHgsIHksIHtyYWRpdXMsIGRpbW1lZENvbG9yfSkgPT4ge1xuXHRyZXR1cm4gJ3JhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgJyArIHggKyAncHggJyArIHkgKyAncHgsIHRyYW5zcGFyZW50ICcgKyByYWRpdXMgKyAncHgsICcrIGRpbW1lZENvbG9yICsgJyAwKSc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcblx0aXNNYWMsXG5cdGdldE1hc2tCYWNrZ3JvdW5kXG59IiwiaW1wb3J0IHtpc01hY30gZnJvbSAnLi91dGlsJ1xuXG5leHBvcnQgY29uc3QgS0VZX0NPREUgPSB7XG5cdEVTQzogMjcsXG5cdFNISUZUOiAxNixcblx0Q1RSTDogaXNNYWMoKSA/IDkxOiAxN1xufTtcbiIsImltcG9ydCB7S0VZX0NPREV9IGZyb20gXCIuL2NvbmZpZ1wiO1xuaW1wb3J0IHV0aWwgZnJvbSAnLi91dGlsJ1xuaW1wb3J0IFwiLi9wb2x5ZmlsbFwiXG5cbmNsYXNzIFNwb3RMaWdodCB7XG5cdGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcblx0XHR0aGlzLmNoYW5nZU9wdGlvbihvcHRpb25zKTtcblx0XHR0aGlzLl9hdHRhY2hFdmVudCgpO1xuXHR9XG5cblx0X2NvbXB1dGVPcHRpb25zKG9wdGlvbnMpIHtcblx0XHRsZXQgZWwgPSBvcHRpb25zLmVsIHx8IGRvY3VtZW50LmJvZHkuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cblx0XHRsZXQgZGVmYXVsdE9wdGlvbnMgPSB7XG5cdFx0XHRkaW1tZWRDb2xvcjogYHJnYmEoMCwwLDAsMC40KWAsXG5cdFx0XHR6b29tZWRDb2xvcjogJyNmZmYnIHx8IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKVsnYmFja2dyb3VuZENvbG9yJ10sIC8v7J6E7IucIOy9lOuTnFxuXHRcdFx0em9vbUtleTogdXRpbC5pc01hYygpPyAnbWV0YUtleSc6ICdjdHJsS2V5Jyxcblx0XHRcdHpvb21TY2FsZTogMixcblx0XHRcdHpJbmRleDogMTAwMCxcblx0XHRcdGVsOiBlbCxcblx0XHRcdHJhZGl1czogb3B0aW9ucy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCAvIDQsXG5cdFx0fTtcblxuXHRcdHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cdH1cblxuXHRjaGFuZ2VPcHRpb24ob3B0aW9ucykge1xuXHRcdHRoaXMub3B0aW9ucyA9IHRoaXMuX2NvbXB1dGVPcHRpb25zKG9wdGlvbnMpO1xuXHR9XG5cblx0X2F0dGFjaEV2ZW50KCkge1xuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGUpID0+IHtcblx0XHRcdGlmIChLRVlfQ09ERS5TSElGVCA9PT0gZS5rZXlDb2RlKSB7XG5cdFx0XHRcdHRoaXMuc3RvcE1hc2soKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKEtFWV9DT0RFLkNUUkwgPT09IGUua2V5Q29kZSkge1xuXHRcdFx0XHR0aGlzLnN0b3Bab29tKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcblx0XHRcdGlmIChLRVlfQ09ERS5TSElGVCA9PT0gZS5rZXlDb2RlKSB7XG5cdFx0XHRcdHRoaXMuc3RhcnRNYXNrKCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChlLnNoaWZ0S2V5ICYmIEtFWV9DT0RFLkNUUkwgPT09IGUua2V5Q29kZSkge1xuXHRcdFx0XHR0aGlzLnN0YXJ0Wm9vbShlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMub25Nb3ZlLmJpbmQodGhpcykpO1xuXHR9XG5cblx0cmVtb3ZlKCkge1xuXG5cdH1cblxuXHRzdGFydE1hc2soKSB7XG5cdFx0aWYodGhpcy4kbWFzaykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLiRtYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy4kbWFzay5jbGFzc0xpc3QuYWRkKCdzcG90bGlnaHQtbWFzaycpO1xuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy4kbWFzayk7XG5cdFx0dGhpcy5zZXRNYXNrKCk7XG5cdH1cblxuXHRzZXRNYXNrKCkge1xuXHRcdGxldCBpbWFnZUNzcyA9IHV0aWwuZ2V0TWFza0JhY2tncm91bmQodGhpcy54LCB0aGlzLnksIHRoaXMub3B0aW9ucyk7XG5cdFx0dGhpcy4kbWFzay5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYFxuXHRcdFx0YmFja2dyb3VuZC1pbWFnZTogJHtpbWFnZUNzc307IFxuXHRcdFx0YmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC0ke2ltYWdlQ3NzfTtcblx0XHRcdHBvc2l0aW9uOiBmaXhlZDtcblx0XHRcdGxlZnQ6IDA7XG5cdFx0XHR0b3A6IDA7XG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdGhlaWdodDogMTAwJTtcblx0XHRcdGN1cnNvcjogbm9uZTtcblx0XHRcdHotaW5kZXg6ICR7dGhpcy5vcHRpb25zLnpJbmRleH1gKVxuXHR9XG5cblx0c3RvcE1hc2soKSB7XG5cdFx0dGhpcy4kbWFzayAmJiB0aGlzLiRtYXNrLnJlbW92ZSgpO1xuXHRcdHRoaXMuc3RvcFpvb20oKTtcblx0XHR0aGlzLiRtYXNrID0gbnVsbDtcblx0fVxuXHRzdGFydFpvb20oKSB7XG5cdFx0aWYodGhpcy4kem9vbSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLiR6b29tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy4kem9vbS5jbGFzc0xpc3QuYWRkKCdzcG90bGlnaHQtem9vbScpO1xuXHRcdHRoaXMuJHpvb21Db250ZW50ID0gdGhpcy5vcHRpb25zLmVsLmNsb25lTm9kZSh0cnVlKTtcblx0XHR0aGlzLiR6b29tQ29udGVudC5jbGFzc0xpc3QuYWRkKCdzcG90bGlnaHQtem9vbS1jb250ZW50Jyk7XG5cdFx0dGhpcy4kem9vbS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYFxuXHRcdFx0d2lkdGg6ICR7dGhpcy5vcHRpb25zLnJhZGl1cyAqIDJ9cHg7IFxuXHRcdFx0aGVpZ2h0OiAke3RoaXMub3B0aW9ucy5yYWRpdXMgKiAyfXB4O1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdHBvc2l0aW9uOiBmaXhlZDtgXG5cdFx0KTtcblx0XHR0aGlzLiR6b29tQ29udGVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYFxuXHRcdFx0d2lkdGg6ICR7dGhpcy5vcHRpb25zLmVsLm9mZnNldFdpZHRofXB4OyBcblx0XHRcdGhlaWdodDogJHt0aGlzLm9wdGlvbnMuZWwub2Zmc2V0SGVpZ2h0fXB4O1xuXHRcdFx0YmFja2dyb3VuZC1jb2xvcjogJHt0aGlzLm9wdGlvbnMuem9vbWVkQ29sb3J9O1xuXHRcdFx0cG9zaXRpb246IGZpeGVkO1xuXHRcdFx0dHJhbnNmb3JtOiBzY2FsZSgke3RoaXMub3B0aW9ucy56b29tU2NhbGV9KTtcblx0XHRcdG92ZXJmbG93OiAke3RoaXMub3B0aW9ucy5lbC5zdHlsZS5vdmVyZmxvd307XG5cdFx0XHR6LWluZGV4OiAke3RoaXMub3B0aW9ucy56SW5kZXggKyAxfWBcblx0XHQpO1xuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy4kem9vbSk7XG5cdFx0dGhpcy4kem9vbS5hcHBlbmRDaGlsZCh0aGlzLiR6b29tQ29udGVudCk7XG5cdFx0dGhpcy5lbFJlY3QgPSB0aGlzLm9wdGlvbnMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0dGhpcy4kem9vbUNvbnRlbnQuc2Nyb2xsVG9wID0gcGFyc2VJbnQodGhpcy5vcHRpb25zLmVsLnNjcm9sbFRvcCwgMTApO1xuXHRcdHRoaXMuJHpvb21Db250ZW50LnNjcm9sbExlZnQgPSBwYXJzZUludCh0aGlzLm9wdGlvbnMuZWwuc2Nyb2xsTGVmdCwgMTApO1xuXHRcdHRoaXMuc2V0Wm9vbSgpO1xuXHR9XG5cblx0c2V0Wm9vbSgpIHtcblx0XHRsZXQgc2NhbGUgPSB0aGlzLm9wdGlvbnMuem9vbVNjYWxlO1xuXHRcdHRoaXMuJHpvb20uc3R5bGUudG9wID0gYCR7dGhpcy55IC0gdGhpcy5vcHRpb25zLnJhZGl1cyB9cHhgO1xuXHRcdHRoaXMuJHpvb20uc3R5bGUubGVmdCA9IGAke3RoaXMueCAtIHRoaXMub3B0aW9ucy5yYWRpdXMgfXB4YDtcblx0XHR0aGlzLiR6b29tQ29udGVudC5zdHlsZS50b3AgPSBgJHt0aGlzLnkgLSB0aGlzLm9wdGlvbnMucmFkaXVzfXB4YDtcblx0XHR0aGlzLiR6b29tQ29udGVudC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy54IC0gdGhpcy5vcHRpb25zLnJhZGl1c31weGA7XG5cdFx0dGhpcy4kem9vbUNvbnRlbnQuc3R5bGUubWFyZ2luVG9wID0gLSBzY2FsZSAqICh0aGlzLnkgLSB0aGlzLmVsUmVjdC50b3ApICsgdGhpcy5vcHRpb25zLmVsLm9mZnNldEhlaWdodCAqIChzY2FsZSAtMSkvMiArIHRoaXMub3B0aW9ucy5yYWRpdXMgKyAncHgnO1xuXHRcdHRoaXMuJHpvb21Db250ZW50LnN0eWxlLm1hcmdpbkxlZnQgPSAtIHNjYWxlICogKHRoaXMueCAtIHRoaXMuZWxSZWN0LmxlZnQpICsgdGhpcy5vcHRpb25zLmVsLm9mZnNldFdpZHRoICogKHNjYWxlIC0xKS8yICsgdGhpcy5vcHRpb25zLnJhZGl1cyArICdweCc7XG5cdH1cblxuXHRzdG9wWm9vbSgpIHtcblx0XHR0aGlzLiR6b29tICYmIHRoaXMuJHpvb20ucmVtb3ZlKCk7XG5cdFx0dGhpcy4kem9vbSA9IG51bGw7XG5cdH1cblxuXHRvbk1vdmUoZSkge1xuXHRcdHRoaXMueCA9IGUuY2xpZW50WDtcblx0XHR0aGlzLnkgPSBlLmNsaWVudFk7XG5cblx0XHRpZighdGhpcy4kbWFzaykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICghZS5zaGlmdEtleSkge1xuXHRcdFx0dGhpcy5zdG9wTWFzaygpO1xuXHRcdH1cblxuXHRcdGlmICghZVt0aGlzLm9wdGlvbnMuem9vbUtleV0gJiYgdGhpcy4kem9vbSkge1xuXHRcdFx0dGhpcy5zdG9wWm9vbSgpO1xuXHRcdH1cblxuXHRcdHRoaXMuc2V0TWFzaygpO1xuXG5cdFx0aWYgKGVbdGhpcy5vcHRpb25zLnpvb21LZXldKSB7XG5cdFx0XHR0aGlzLnNldFpvb20oKTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IHtTcG90TGlnaHR9XG4iLCIvLyBmcm9tOmh0dHBzOi8vZ2l0aHViLmNvbS9qc2Vyei9qc19waWVjZS9ibG9iL21hc3Rlci9ET00vQ2hpbGROb2RlL3JlbW92ZSgpL3JlbW92ZSgpLm1kXG4oZnVuY3Rpb24gKGFycikge1xuXHRhcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdGlmIChpdGVtLmhhc093blByb3BlcnR5KCdyZW1vdmUnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXRlbSwgJ3JlbW92ZScsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHR3cml0YWJsZTogdHJ1ZSxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG5cdFx0XHRcdGlmICh0aGlzLnBhcmVudE5vZGUgIT09IG51bGwpXG5cdFx0XHRcdFx0dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn0pKFtFbGVtZW50LnByb3RvdHlwZSwgQ2hhcmFjdGVyRGF0YS5wcm90b3R5cGUsIERvY3VtZW50VHlwZS5wcm90b3R5cGVdKTsiXSwic291cmNlUm9vdCI6IiJ9